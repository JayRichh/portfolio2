<div class="donut-chart-container">
  <div class="chart-header">
    <h3>Code Composition</h3>
    <!-- <app-info-tooltip
      [content]="'Lines of code and file counts are estimated based on language-specific averages. Actual numbers may vary based on coding style and file organization.'"
    /> -->
  </div>

  <div class="chart-layout">
    <div class="chart-section">
      <div class="chart-wrapper">
        <svg #svgContainer class="donut-svg"></svg>
        <div class="chart-footer">
          <div class="chart-footer-item">
            Total Lines: {{ formatNumber(data().totalLines) }}
          </div>
          <div class="chart-footer-item">
            Total Files: {{ formatNumber(data().totalFiles) }}
          </div>
        </div>
      </div>
    </div>

    <div class="stats-section">
      <div class="stats-scroll-container">
        <div class="stats-grid">
          <div
            *ngFor="let lang of topLanguages()"
            class="stat-item"
            [class.highlighted]="highlightedLanguage() === lang.name"
            (mouseenter)="onLanguageHover(lang.name)"
            (mouseleave)="onLanguageLeave()"
          >
            <div class="stat-header">
              <div class="stat-name">
                <div
                  class="stat-color"
                  [style.background]="lang.color"
                ></div>
                <span>{{ lang.name }}</span>
              </div>
              <span class="stat-percentage">{{ lang.percentage }}%</span>
            </div>

            @if (lang.percentage >= 1) {
              <div class="stat-progress">
                <div
                  class="stat-progress-fill"
                  [style.width.%]="lang.percentage"
                  [style.background]="lang.color"
                ></div>
              </div>
            }

            <div class="stat-details">
              <span class="stat-detail">
                {{ formatNumber(lang.lineCount) }} lines
              </span>
              <span class="stat-detail">
                {{ formatNumber(lang.fileCount) }} files
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <app-chart-tooltip #tooltip />
</div>
